Work in progress. See the tests meanwhile.